<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style></style>
</head>
<body>
<div data-x-todo-app-id="idp1">
<form class="$form" data-x-idp1="">
<input type="text" class="$text" data-x-idp1=""><button type="submit">Add todo</button>
</form>
<div class="$todos" data-x-idp1="">
<div class="$totoItem" data-x-todo-item-id="idp2">Buy milk<button class="$remove" type="button" data-x-idp2="">Remove</button>
</div>
<div class="$totoItem" data-x-todo-item-id="idp3">Buy bread<button class="$remove" type="button" data-x-idp3="">Remove</button>
</div>
</div>
</div>
<script>window.xsalt={components:{}}; window.xsalt.defComponent=function(tag,node){ if(!window.xsalt.components[tag])window.xsalt.components[tag]={instances:{}}; Array.prototype.slice.call( node?[node]:document.querySelectorAll('[data-x-'+tag+'-id]') ).forEach(function(n,i){ window.xsalt.components[tag].instances[n.getAttribute('data-x-'+tag+'-id')]={refs:{},tag:tag,id:n.getAttribute('data-x-'+tag+'-id')}; }); }; window.xsalt.autoselect=function(tag,node,wrapper){ var c; Array.prototype.slice.call( node?[node]:document.querySelectorAll('[data-x-'+tag+'-id]') ).forEach(function(n,i){ c=window.xsalt.components[tag].instances[n.getAttribute('data-x-'+tag+'-id')]; var els=Array.prototype.slice.call(n.querySelectorAll('[data-x-'+n.getAttribute('data-x-'+tag+'-id')+'][class*="$"]')); els.push(n); els.forEach(function(e){ Array.prototype.slice.call(e.classList).forEach(function(className){ if(className.indexOf('$')!==0)return; var el=className.slice(1); if(!c.refs[el])c.refs[el]=e; else if(Array.isArray(c.refs[el]))c.refs[el].push(e); else c.refs[el]=[c.refs[el],e]; }); }); if(wrapper)for(var e in c.refs)c.refs[e]=wrapper(c.refs[e]); }); return node?[c]:Object.values(window.xsalt.components[tag].instances); }; window.xsalt.importXsl=function(url){ return new Promise(function(res,rej){ var xhr=new XMLHttpRequest(); xhr.open('GET',url,true); xhr.onload=function(){ var xsl=xhr.responseXML; window.xsalt.XSLTProcessor=new XSLTProcessor(); window.xsalt.XSLTProcessor.importStylesheet(xsl); xsl=document.implementation.createDocument('','',null); window.xsalt.DOMParser=new DOMParser(); window.xsalt.customElements.define(['todo-item',]); if(xhr.status>=200&&xhr.status<300)res(xhr.response); else rej({status:xhr.status,statusText:xhr.statusText}); }; xhr.onerror=function(){rej({status:xhr.status,statusText:xhr.statusText})}; xhr.send(null); }); }; window.xsalt.customElements={ id:0, define:function(tag){ if(Array.isArray(tag)){tag.forEach(window.xsalt.customElements.define);return;} if(window.customElements.get(tag))return; window.customElements.define(tag,class extends HTMLElement{constructor(){super(); var doc=window.xsalt.DOMParser.parseFromString(this.outerHTML,'application/xml'); var fragment=window.xsalt.XSLTProcessor.transformToFragment(doc,document); var node=fragment.firstElementChild; this.replaceWith(node); const xId=node.getAttribute('data-x-'+tag+'-id'); node.setAttribute('data-x-'+tag+'-id','id-ce-'+(++window.xsalt.customElements.id)); node.querySelectorAll('[data-x-'+xId+']').forEach(function(n){ n.removeAttribute('data-x-'+xId); n.setAttribute('data-x-'+'id-ce-'+window.xsalt.customElements.id,''); }); window.xsalt.defComponent(tag); window.xsalt.autoselect( tag, node, window.xsalt.components[tag].wrapper ).forEach(function(c){window.xsalt.components[tag].init.call(c)}); }})} }; window.xsalt.importXsl('./includes.xsl');</script><script>window.xsalt.defComponent('todo-app',null);window.xsalt.components['todo-app'].init=function(){var $refs=this.refs;/**/
    $refs.form.addEventListener('submit', function (e) {
      e.preventDefault();
      $refs.todos.insertAdjacentHTML('beforeend',
        '<todo-item>' + $refs.text.value + '</todo-item>'
      );
    });
  /**/};window.xsalt.components['todo-app'].wrapper=null;window.xsalt.autoselect('todo-app',null,window.xsalt.components['todo-app'].wrapper).forEach(function(c){window.xsalt.components['todo-app'].instances[c.id].$this=window.xsalt.components['todo-app'].init.call(c)});window.xsalt.defComponent('todo-item',null);window.xsalt.components['todo-item'].init=function(){var $refs=this.refs;
    $refs.remove.addEventListener('click', function () {
      $refs.totoItem.remove();
    });
  };window.xsalt.components['todo-item'].wrapper=null;window.xsalt.autoselect('todo-item',null,window.xsalt.components['todo-item'].wrapper).forEach(function(c){window.xsalt.components['todo-item'].instances[c.id].$this=window.xsalt.components['todo-item'].init.call(c)});</script>
</body>
</html>
